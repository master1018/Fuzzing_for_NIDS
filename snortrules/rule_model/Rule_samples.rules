alert ip any any -> any any ( msg:"OS-LINUX Linux kernel IGMP queries denial of service attempt"; ip_proto:2; content:"|11|",depth 1; content:"|00|",within 1; metadata:policy max-detect-ips drop; reference:cve,2012-0207; classtype:denial-of-service; sid:25314; rev:8; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-LINUX Linux kernel sctp_rcv_ootb invalid chunk length DoS attempt"; ip_proto:132; content:"|00 00|",depth 2,offset 14; metadata:policy max-detect-ips drop; reference:bugtraq,38857; reference:cve,2010-0008; classtype:attempted-dos; sid:18997; rev:7; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.AllAple Variant ICMP flood"; dsize:33; itype:8; content:"Babcdefghijklmnopqrstuvwabcdefghi",fast_pattern,nocase; detection_filter:track by_src, count 20, seconds 10; metadata:impact_flag red,policy balanced-ips alert,policy security-ips alert; reference:url,www.virustotal.com/en/file/a6e05ad7748f9aa5a9ba6bf28b62ef3304319a7bf1699de837cd5019cdce02f5/analysis/; classtype:trojan-activity; sid:28463; rev:4; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Yoddos outbound indicator"; itype:8; icode:0; content:"YYYYYYYYYYYYYYYYYYYYYYYYYYYY"; metadata:policy balanced-ips drop,policy security-ips drop; reference:url,www.virustotal.com/en/file/a7f97ed5c064b038279dbd02554c7e555d97f67b601b94bfc556a50a41dae137/analysis/; classtype:trojan-activity; sid:19769; rev:7; )
alert udp $EXTERNAL_NET any -> $HOME_NET 20010 ( msg:"PROTOCOL-SCADA Yokogawa CS3000 BKFSim_vhfd buffer overflow attempt"; flow:to_server; content:"|45 54 56 48 01 01 10 09 00 00 00 01 00 00 00 44|",fast_pattern,nocase; isdataat:460; content:"|9C 5C E5 61|",depth 4,offset 454; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2014-3888; classtype:attempted-admin; sid:41778; rev:2; )
alert udp $EXTERNAL_NET any -> $HOME_NET 123 ( msg:"SERVER-OTHER NTP arbitrary pidfile and driftfile overwrite attempt"; flow:to_server; content:"pidfile",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ntp; reference:bugtraq,77278; reference:cve,2015-7703; reference:url,attack.mitre.org/techniques/T1209; reference:url,support.ntp.org/bin/view/Main/NtpBug2902; classtype:policy-violation; sid:37526; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 4500 ( msg:"SERVER-OTHER tcpdump ISAKMP parser buffer overflow attempt"; flow:to_server; content:"|00 00 00 00|",depth 4; content:"|21 20 22|",within 3,distance 16,fast_pattern; content:!"|00|",within 1,distance 13; content:!"|02|",within 1,distance 13; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; reference:cve,2017-5205; classtype:attempted-user; sid:44160; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"SERVER-WEBAPP Dream Report ASPX file upload attempt"; flow:to_server,established; http_uri; content:"/DRweb_Demo/WebAPI/WebCmd.svc/UploadFile",fast_pattern,nocase; http_client_body; content:"CjwlQC"; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; reference:url,dreamreport.net; classtype:web-application-attack; sid:46530; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Backdoor.Tavdig variant outbound connection"; flow:to_server,established; http_uri; content:"/?rank=",fast_pattern; http_cookie; content:"number=",depth 7; http_client_body; content:"Result=",depth 7; content:!"&"; http_cookie; pcre:"/^number=[0-9A-F]{32}$/m"; metadata:impact_flag red; service:http; reference:url,www.virustotal.com/en/file/0b97c87126578113050d8e014e8fefeb33146eebc40e75c070882ec31ae26aab/analysis/; classtype:trojan-activity; sid:28879; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Locky dropper variant outbound request detected"; flow:to_server,established; http_uri; content:"/IUGiwe8",fast_pattern,nocase; http_header; content:"UA-CPU: AMD64"; metadata:impact_flag red,policy balanced-ips drop,policy security-ips drop; service:http; reference:url,virustotal.com/#/file/1b80b24b7195960a74cc10dbbc9685ae229443a80d11c7fe7a9c8fdd4e59840d/detection; classtype:trojan-activity; sid:44610; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE potential malware - download of svchost.exe"; flow:to_server,established; http_method; content:"GET"; http_uri; content:"/svchost.exe",fast_pattern,nocase; pcre:"/\x2fsvchost\x2eexe$/smi"; metadata:policy max-detect-ips drop; service:http; classtype:suspicious-filename-detect; sid:17811; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RMD overflow attempt"; flow:to_server,established; content:"RMD",nocase; isdataat:100,relative; pcre:"/^RMD(?!\n)\s[^\n]{100}/smi"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,15457; reference:bugtraq,2972; reference:bugtraq,39041; reference:cve,2000-0133; reference:cve,2001-0826; reference:cve,2001-1021; reference:cve,2005-3683; reference:cve,2010-0625; classtype:attempted-admin; sid:1976; rev:23; )
alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS ( msg:"PROTOCOL-FTP ProFTPD mod_copy remote code execution attempt"; flow:to_server,established; content:"SITE",depth 4,nocase; content:"CPFR",within 4,distance 1,nocase; content:"/proc/",distance 0,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp; reference:bugtraq,74238; reference:cve,2015-3306; classtype:attempted-admin; sid:34225; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1020 ( msg:"MALWARE-BACKDOOR Vampire 1.2 connection request"; flow:to_server,established; content:"Hello...",depth 8; flowbits:set,backdoor.vampire_12.connect; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3063; rev:6; )
alert tcp $HOME_NET 1020 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Vampire 1.2 connection confirmation"; flow:to_client,established; flowbits:isset,backdoor.vampire_12.connect; content:"Vampire v1.2 Server On-Line.....",depth 32; metadata:ruleset community; classtype:misc-activity; sid:3064; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR coolcat runtime connection detection - tcp 3"; flow:to_client,established; flowbits:isset,CoolCat.2; content:"psswd",fast_pattern,nocase; content:"password",distance 0,nocase; pcre:"/^psswd((ok\*\-\*Password\s+OK\r\n)|(error\*\-\*Wrong\s+password\r\n))/smi"; reference:url,www.spywareguide.com/product_show.php?id=555; classtype:trojan-activity; sid:6014; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: ( msg:"MALWARE-BACKDOOR coolcat runtime connection detection - tcp 2"; flow:to_server,established; flowbits:isset,CoolCat.1; content:"password |22|",depth 10,nocase; flowbits:set,CoolCat.2; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=555; classtype:trojan-activity; sid:6013; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-BACKDOOR coolcat runtime connection detection - tcp 1"; flow:to_server,established; content:"testforconnection|0D 0A|",depth 19,nocase; flowbits:set,CoolCat.1; flowbits:noalert; reference:url,www.spywareguide.com/product_show.php?id=555; classtype:trojan-activity; sid:6012; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP partial body buffer overflow attempt"; flow:to_server,established; content:"PARTIAL",nocase; content:"BODY[",distance 0,nocase; isdataat:1024,relative; pcre:"/\sPARTIAL.*?BODY\[[^\]]{1024}/smi"; metadata:ruleset community; service:imap; reference:bugtraq,4713; reference:cve,2002-0379; reference:nessus,10966; classtype:misc-attack; sid:1755; rev:24; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"OS-WINDOWS Microsoft Windows empty RDP cookie negotiation attempt"; flow:to_server,established; content:"|08 E0 00 00 00 00|",depth 6,offset 4; content:"|0D 0A|",within 2,distance 1; isdataat:!1,relative; metadata:policy security-ips drop,ruleset community; service:rdp; reference:cve,2017-0176; reference:cve,2017-9073; reference:url,www.securitytracker.com/id/1038264; classtype:policy-violation; sid:42255; rev:3; )
